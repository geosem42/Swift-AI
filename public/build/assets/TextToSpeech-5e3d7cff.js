import{d as p,r as v,o as a,b as y,w as b,f as t,i,j as r,m as d,z as g,n as c,F as u,l as h,t as n,x as _,p as L,k}from"./app-9e33c640.js";import{A as V}from"./AppLayout-2b6f5ed3.js";import{h as S}from"./moment-fbc5633a.js";import{f as m,p as N,q as w,n as F,r as A}from"./apiService-34b53e87.js";import{_ as C}from"./_plugin-vue_export-helper-c27b6911.js";const M=p({components:{AppLayout:V},data(){return{voices:[],selectedLanguage:"",selectedVoice:"",message:null,isLoading:!1,areSelectFieldsLoading:!0,errors:{},audioFiles:[],currentPage:1,lastPage:null,isFetchingMore:!1}},methods:{async fetchVoices(){this.areSelectFieldsLoading=!0;try{const e=await m(),s=await N(e);this.voices=s,this.setDefaultVoice()}catch(e){console.error("Error fetching voices:",e)}finally{this.areSelectFieldsLoading=!1}},async narrate(){this.isLoading=!0;try{const e=await m(),s=await w(e,this.selectedLanguage,this.selectedVoice,this.message);s&&s.file&&this.audioFiles.unshift({filename:s.file,voice:this.selectedVoice,language:this.selectedLanguage,message:this.message}),this.isLoading=!1}catch(e){this.isLoading=!1,e.source==="frontend"?this.errors=e.errors:this.errors=F(e||{message:["An unexpected error occurred."]})}finally{this.isLoading=!1}},async fetchAudioFiles(e=1){e>1&&(this.isFetchingMore=!0);try{const s=await A(e);s&&s.data&&(this.audioFiles=[...this.audioFiles,...s.data],this.currentPage=s.current_page,this.lastPage=s.last_page)}catch(s){console.error("Error fetching audio files:",s)}finally{e>1&&(this.isFetchingMore=!1)}},loadMore(){this.fetchAudioFiles(this.currentPage+1)},setDefaultVoice(){const e=this.filteredVoices;if(e.length>0){const s=e.find(l=>l.ShortName==="en-US-DavisNeural");this.selectedVoice=s?s.ShortName:e[0].ShortName}else this.selectedVoice=null},onLanguageChange(){this.setDefaultVoice()},formatName(e){const s=e.split("-");let l=s.length>2?s[2]:e;return l.endsWith("Neural")&&(l=l.slice(0,-6)),l},formatCreatedAt(e){return S(e).fromNow()},clearError(e){this.errors[e]&&(this.errors[e]="")}},mounted(){this.fetchVoices(),this.fetchAudioFiles()},computed:{languages(){const e=new Set;return Array.isArray(this.voices)&&this.voices.forEach(s=>{e.add(JSON.stringify({name:s.LocaleName,code:s.Locale}))}),Array.from(e).map(JSON.parse)},filteredVoices(){return Array.isArray(this.voices)?this.voices.filter(e=>e.Locale===this.selectedLanguage):[]},showLoadMoreButton(){return this.audioFiles.length%(10+1)===0&&this.audioFiles.length>0}},watch:{filteredVoices(e){this.selectedVoice=e.length>0?e[0].ShortName:null}}}),T={class:"h-100"},D={key:0,class:"d-flex justify-content-center align-items-center h-100"},E=t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),P=[E],$={key:1,class:"container-fluid px-4"},B=t("h1",{class:"mt-4"},"Text To Speech",-1),U={class:"row"},j={class:"col-12"},z={class:"row g-3"},I={class:"col-md-6"},J=t("label",{for:"language",class:"form-label"},"Language",-1),O=t("option",{disabled:"",value:""},"Please select a language",-1),q=["value"],W={key:0,class:"invalid-feedback"},Y={class:"col-md-6"},G=t("label",{for:"voice",class:"form-label"},"Voice",-1),H=["disabled"],K=t("option",{disabled:"",value:""},"Please select a voice",-1),Q=["value"],R={key:0,class:"invalid-feedback"},X={class:"col-12"},Z=t("label",{for:"message",class:"form-label"},"Message",-1),x={key:0,class:"invalid-feedback"},ee={class:"col-12"},se=["disabled"],te={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},oe={key:1},ae={class:"row mt-5"},ie={class:"col-12"},re={class:"list-group mb-5"},ne={class:"d-flex w-100 justify-content-between"},le={class:"mb-1"},de={class:"mb-1"},ce=["src"],ue={id:"loadmore",class:"text-center"},he={key:1,class:"spinner-border text-primary mt-4",role:"status"},ge=t("span",{class:"visually-hidden"},"Loading...",-1),me=[ge];function fe(e,s,l,pe,ve,ye){const f=v("app-layout");return a(),y(f,{title:"Text To Speech"},{default:b(()=>[t("main",T,[e.areSelectFieldsLoading?(a(),i("div",D,P)):r("",!0),e.areSelectFieldsLoading?r("",!0):(a(),i("div",$,[B,t("div",U,[t("div",j,[t("form",z,[t("div",I,[J,d(t("select",{class:c(["form-select",{"is-invalid":e.errors.language}]),"aria-label":"Default select example",id:"language","onUpdate:modelValue":s[0]||(s[0]=o=>e.selectedLanguage=o),onChange:s[1]||(s[1]=(...o)=>e.onLanguageChange&&e.onLanguageChange(...o)),onInput:s[2]||(s[2]=o=>e.clearError("language")),name:"language"},[O,(a(!0),i(u,null,h(e.languages,o=>(a(),i("option",{value:o.code,key:o.code},n(o.name),9,q))),128))],34),[[g,e.selectedLanguage]]),e.errors.language?(a(),i("div",W,n(e.errors.language[0]),1)):r("",!0)]),t("div",Y,[G,d(t("select",{class:c(["form-select",{"is-invalid":e.errors.voice}]),"aria-label":"Default select example",id:"voice","onUpdate:modelValue":s[3]||(s[3]=o=>e.selectedVoice=o),disabled:!e.selectedLanguage,onInput:s[4]||(s[4]=o=>e.clearError("voice")),name:"voice"},[K,(a(!0),i(u,null,h(e.filteredVoices,o=>(a(),i("option",{value:o.ShortName,key:o.ShortName},n(o.DisplayName),9,Q))),128))],42,H),[[g,e.selectedVoice]]),e.errors.voice?(a(),i("div",R,n(e.errors.voice[0]),1)):r("",!0)]),t("div",X,[Z,d(t("textarea",{name:"message",id:"message",cols:"30",rows:"10",class:c(["form-control",{"is-invalid":e.errors.message}]),"onUpdate:modelValue":s[5]||(s[5]=o=>e.message=o),onInput:s[6]||(s[6]=o=>e.clearError("message"))},null,34),[[_,e.message]]),e.errors.message?(a(),i("div",x,n(e.errors.message[0]),1)):r("",!0)]),t("div",ee,[t("button",{type:"submit",class:"btn btn-primary btn-lg",onClick:s[7]||(s[7]=L((...o)=>e.narrate&&e.narrate(...o),["prevent"])),disabled:e.isLoading},[e.isLoading?(a(),i("span",te)):r("",!0),e.isLoading?r("",!0):(a(),i("span",oe,"Narrate"))],8,se)])])])]),t("div",ae,[t("div",ie,[t("div",re,[(a(!0),i(u,null,h(e.audioFiles,(o,be)=>(a(),i("a",{key:o.id,class:"list-group-item list-group-item-action","aria-current":"true"},[t("div",ne,[t("h5",le,[t("strong",null,n(e.formatName(o.voice)),1),k(" ("+n(o.language)+")",1)]),t("small",null,n(e.formatCreatedAt(o.created_at)),1)]),t("p",de,n(o.message),1),t("small",null,[t("audio",{controls:"",src:"/storage/audio/"+o.filename}," Your browser does not support the audio element. ",8,ce)])]))),128))]),t("div",ue,[!e.isFetchingMore&&e.currentPage<e.lastPage?(a(),i("button",{key:0,class:"btn btn-lg btn-secondary mb-5",onClick:s[8]||(s[8]=(...o)=>e.loadMore&&e.loadMore(...o))},"Load More")):r("",!0),e.isFetchingMore?(a(),i("div",he,me)):r("",!0)])])])]))])]),_:1})}const Ne=C(M,[["render",fe]]);export{Ne as default};
