import{d as v,r as i,o as s,i as r,f as e,h as S,e as n,w as t,k as a,t as h,n as p,y as T,m as g,v as y,b,j as u,F as R,l as A}from"./app-9e33c640.js";import{a as B,J as E}from"./DialogModal-875d4055.js";import{J as C}from"./Button-6a91530d.js";import{J as V}from"./Input-2edcdd1e.js";import{J as q}from"./InputError-fc966430.js";import{J as $}from"./SecondaryButton-332648cf.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import{J as L}from"./DangerButton-367a0726.js";const M=v({emits:["confirmed"],props:{title:{default:"Confirm Password"},content:{default:"For your security, please confirm your password to continue."},button:{default:"Confirm"}},components:{JetButton:C,JetDialogModal:B,JetInput:V,JetInputError:q,JetSecondaryButton:$},data(){return{modal:null,form:this.$inertia.form({password:"",error:""},{bag:"confirmPassword"})}},methods:{startConfirmingPassword(){this.form.error="";let o=document.querySelector("#confirmingPasswordModal");this.modal=new bootstrap.Modal(o),axios.get(route("password.confirmation")).then(d=>{d.data.confirmed?this.$emit("confirmed"):(this.modal.toggle(),this.form.password="",setTimeout(()=>{this.$refs.password.focus()},250))})},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then(o=>{this.bootstrap.modal("hide"),this.form.password="",this.form.error="",this.form.processing=!1,this.$nextTick(()=>this.$emit("confirmed"))}).catch(o=>{this.form.processing=!1,this.form.error=o.response.data.errors.password[0]})}}}),D={class:"mt-4"},N={class:"spinner-border spinner-border-sm",role:"status"},K=e("span",{class:"visually-hidden"},"Loading...",-1),Q=[K];function Y(o,d,k,F,J,P){const f=i("jet-input"),c=i("jet-input-error"),m=i("jet-secondary-button"),_=i("jet-button"),w=i("jet-dialog-modal");return s(),r("span",null,[e("span",{onClick:d[0]||(d[0]=(...l)=>o.startConfirmingPassword&&o.startConfirmingPassword(...l))},[S(o.$slots,"default")]),n(w,{id:"confirmingPasswordModal"},{title:t(()=>[a(h(o.title),1)]),content:t(()=>[a(h(o.content)+" ",1),e("div",D,[n(f,{type:"password",placeholder:"Password",ref:"password",modelValue:o.form.password,"onUpdate:modelValue":d[1]||(d[1]=l=>o.form.password=l),class:p({"is-invalid":o.form.error}),onKeyup:T(o.confirmPassword,["enter"])},null,8,["modelValue","class","onKeyup"]),n(c,{message:o.form.error},null,8,["message"])])]),footer:t(()=>[n(m,{"data-bs-dismiss":"modal"},{default:t(()=>[a(" Cancel ")]),_:1}),n(_,{class:p(["ms-2",{"text-black-50":o.form.processing}]),onClick:o.confirmPassword,disabled:o.form.processing},{default:t(()=>[g(e("div",N,Q,512),[[y,o.form.processing]]),a(" "+h(o.button),1)]),_:1},8,["onClick","class","disabled"])]),_:1})])}const H=j(M,[["render",Y]]),I=v({components:{JetActionSection:E,JetButton:C,JetConfirmsPassword:H,JetDangerButton:L,JetSecondaryButton:$},data(){return{enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}},methods:{enableTwoFactorAuthentication(){this.enabling=!0,this.$inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([this.showQrCode(),this.showRecoveryCodes()]),onFinish:()=>this.enabling=!1})},showQrCode(){return axios.get("/user/two-factor-qr-code").then(o=>{this.qrCode=o.data.svg})},showRecoveryCodes(){return axios.get("/user/two-factor-recovery-codes").then(o=>{this.recoveryCodes=o.data})},regenerateRecoveryCodes(){axios.post("/user/two-factor-recovery-codes").then(o=>{this.showRecoveryCodes()})},disableTwoFactorAuthentication(){this.disabling=!0,this.$inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>this.disabling=!1})}},computed:{twoFactorEnabled(){return!this.enabling&&this.$page.props.user.two_factor_enabled}}}),z={key:0,class:"h5 font-weight-bold"},G={key:1,class:"h5 font-weight-bold"},U=e("div",{class:"mt-3"},[e("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),W={key:2},O={key:0},X=e("div",{class:"mt-3"},[e("p",null," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application. ")],-1),Z=["innerHTML"],x={key:1},oo=e("div",{class:"mt-3"},[e("p",null," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),eo={class:"w-75 bg-light rounded p-3"},to={class:"mt-3"},so={key:0},no={class:"spinner-border spinner-border-sm",role:"status"},ro=e("span",{class:"visually-hidden"},"Loading...",-1),ao=[ro],io={key:1},co={class:"spinner-border spinner-border-sm",role:"status"},lo=e("span",{class:"visually-hidden"},"Loading...",-1),uo=[lo];function mo(o,d,k,F,J,P){const f=i("jet-button"),c=i("jet-confirms-password"),m=i("jet-secondary-button"),_=i("jet-danger-button"),w=i("jet-action-section");return s(),b(w,null,{title:t(()=>[a(" Two Factor Authentication ")]),description:t(()=>[a(" Add additional security to your account using two factor authentication. ")]),content:t(()=>[o.twoFactorEnabled?(s(),r("h3",z," You have enabled two factor authentication. ")):(s(),r("h3",G," You have not enabled two factor authentication. ")),U,o.twoFactorEnabled?(s(),r("div",W,[o.qrCode?(s(),r("div",O,[X,e("div",{class:"mt-3",innerHTML:o.qrCode},null,8,Z)])):u("",!0),o.recoveryCodes.length>0?(s(),r("div",x,[oo,e("div",eo,[(s(!0),r(R,null,A(o.recoveryCodes,l=>(s(),r("div",null,h(l),1))),256))])])):u("",!0)])):u("",!0),e("div",to,[o.twoFactorEnabled?(s(),r("div",io,[n(c,{onConfirmed:o.regenerateRecoveryCodes},{default:t(()=>[o.recoveryCodes.length>0?(s(),b(m,{key:0,class:"me-3"},{default:t(()=>[a(" Regenerate Recovery Codes ")]),_:1})):u("",!0)]),_:1},8,["onConfirmed"]),n(c,{onConfirmed:o.showRecoveryCodes},{default:t(()=>[o.recoveryCodes.length==0?(s(),b(m,{key:0,class:"me-3"},{default:t(()=>[a(" Show Recovery Codes ")]),_:1})):u("",!0)]),_:1},8,["onConfirmed"]),n(c,{onConfirmed:o.disableTwoFactorAuthentication},{default:t(()=>[n(_,{class:p({"text-white-50":o.disabling}),disabled:o.disabling},{default:t(()=>[g(e("div",co,uo,512),[[y,o.form.processing]]),a(" Disable ")]),_:1},8,["class","disabled"])]),_:1},8,["onConfirmed"])])):(s(),r("div",so,[n(c,{onConfirmed:o.enableTwoFactorAuthentication},{default:t(()=>[n(f,{type:"button",class:p({"text-white-50":o.enabling}),disabled:o.enabling},{default:t(()=>[g(e("div",no,ao,512),[[y,o.enabling]]),a(" Enable ")]),_:1},8,["class","disabled"])]),_:1},8,["onConfirmed"])]))])]),_:1})}const vo=j(I,[["render",mo]]);export{vo as default};
